<!DOCTYPE html>
<html>
<head>
    <title>Wolfenstein Game - Level 1</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        canvas { width: 100%; height: 100%; cursor: none; }
        #hud { 
            position: absolute; bottom: 0; left: 50%; transform: translateX(-50%); 
            width: 800px; height: auto; pointer-events: none; 
        }
        #healthBar { 
            position: absolute; top: 10px; left: 10px; width: 200px; height: 20px; 
            background: #333; border: 2px solid #fff; 
        }
        #healthFill { 
            width: 100%; height: 100%; background: #f00; 
        }
        #healthText {
            position: absolute; top: 35px; left: 10px; color: white; font-family: Arial;
        }
        #message {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            color: white; font-family: Arial; font-size: 48px; text-align: center; display: none;
        }
    </style>
</head>
<body>
    <img id="hud" src="HeroGun1.png" alt="Hero Gun">
    <div id="healthBar"><div id="healthFill"></div></div>
    <div id="healthText">Health: 100</div>
    <div id="message"></div>
    <script>
        window.onload = function() {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 50);
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            renderer.domElement.addEventListener('click', () => {
                renderer.domElement.requestPointerLock();
            });

            const wallMaterial = new THREE.MeshBasicMaterial({ color: 0x888888 });
            const floorMaterial = new THREE.MeshBasicMaterial({ color: 0x444444 });

            const map = [
                [1, 1, 1, 1, 1, 1, 1, 1, 1, 1],
                [1, 0, 0, 0, 1, 0, 1, 0, 0, 1],
                [1, 0, 1, 0, 1, 0, 0, 0, 1, 1],
                [1, 0, 1, 0, 0, 0, 1, 0, 0, 1],
                [1, 0, 1, 1, 1, 0, 1, 1, 0, 1],
                [1, 0, 0, 0, 1, 0, 0, 1, 0, 1],
                [1, 1, 1, 0, 1, 1, 0, 1, 0, 1],
                [1, 0, 0, 0, 0, 0, 0, 1, 0, 1],
                [1, 0, 1, 1, 1, 1, 0, 0, 0, 1],
                [1, 1, 1, 1, 1, 1, 1, 1, "E", 1]
            ];
            const tileSize = 5;
            const wallHeight = 4;
            const walls = [];

            for (let z = 0; z < 10; z++) {
                for (let x = 0; x < 10; x++) {
                    if (map[z][x] === 1) {
                        const wall = new THREE.Mesh(new THREE.BoxGeometry(tileSize, wallHeight, tileSize), wallMaterial);
                        wall.position.set(x * tileSize - 22.5, wallHeight / 2, z * tileSize - 22.5);
                        walls.push(wall);
                        scene.add(wall);
                    }
                }
            }

            const floor = new THREE.Mesh(new THREE.PlaneGeometry(50, 50), floorMaterial);
            floor.rotation.x = -Math.PI / 2;
            scene.add(floor);

            const playerHitbox = new THREE.Box3(new THREE.Vector3(), new THREE.Vector3());
            camera.position.set(-20, 2.5, -20);

            function checkCollision(newPosition) {
                const box = new THREE.Box3().setFromCenterAndSize(newPosition, new THREE.Vector3(1, 3, 1));
                return walls.some(wall => box.intersectsBox(new THREE.Box3().setFromObject(wall)));
            }

            const keys = {};
            document.addEventListener('keydown', (event) => keys[event.key.toLowerCase()] = true);
            document.addEventListener('keyup', (event) => keys[event.key.toLowerCase()] = false);

            document.addEventListener('mousemove', (event) => {
                if (document.pointerLockElement === renderer.domElement) {
                    camera.rotation.y -= event.movementX * 0.002;
                }
            });

            function animate() {
                requestAnimationFrame(animate);
                const moveSpeed = 0.2;
                let newX = camera.position.x;
                let newZ = camera.position.z;

                if (keys['w']) {
                    newX -= moveSpeed * Math.sin(camera.rotation.y);
                    newZ -= moveSpeed * Math.cos(camera.rotation.y);
                }
                if (keys['s']) {
                    newX += moveSpeed * Math.sin(camera.rotation.y);
                    newZ += moveSpeed * Math.cos(camera.rotation.y);
                }
                if (keys['a']) {
                    newX -= moveSpeed * Math.cos(camera.rotation.y);
                    newZ += moveSpeed * Math.sin(camera.rotation.y);
                }
                if (keys['d']) {
                    newX += moveSpeed * Math.cos(camera.rotation.y);
                    newZ -= moveSpeed * Math.sin(camera.rotation.y);
                }

                const newPosition = new THREE.Vector3(newX, camera.position.y, newZ);
                if (!checkCollision(newPosition)) {
                    camera.position.copy(newPosition);
                }

                renderer.render(scene, camera);
            }
            animate();
        };
    </script>
</body>
</html>
